<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Verify - Registration</title>
    <script src="https://cdn.tailwindcss.com/3.4.16"></script>
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: { primary: "#F50302", secondary: "#4D4D4D" },
            borderRadius: {
              none: "0px",
              sm: "4px",
              DEFAULT: "8px",
              md: "12px",
              lg: "16px",
              xl: "20px",
              "2xl": "24px",
              "3xl": "32px",
              full: "9999px",
              button: "8px",
            },
          },
        },
      };
    </script>
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Pacifico&display=swap"
      rel="stylesheet"
    />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/remixicon/4.6.0/remixicon.min.css"
    />
    <!-- Supabase -->
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <script id="supabase-config">
      // Initialize Supabase client
      // Supabase project configuration
      const SUPABASE_URL = 'https://dvbbvjlwmkqqyfqdbupg.supabase.co';
      const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR2YmJ2amx3bWtxcXlmcWRidXBnIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTAzNjI0OTYsImV4cCI6MjA2NTkzODQ5Nn0.Zpkj5G3mTngZD2lMCo7Yr6PeyEJ3X6jHndHrvDgPylA';
      
      // Initialize Supabase client using the global supabase object from CDN
      const supabaseClient = window.supabase?.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);
      
      if (!supabaseClient) {
        console.error('‚ùå Failed to initialize Supabase client - CDN may not be loaded');
      } else {
        console.log('‚úÖ Supabase client initialized successfully');
        console.log('üîó Connected to:', SUPABASE_URL);
      }
      
      // Helper function to guide Supabase setup
      function showSupabaseSetupGuide() {
        // Since credentials are now configured, check for database tables
        if (supabaseClient) {
          console.group('üìã Supabase Database Setup');
          console.log('‚úÖ Supabase client connected successfully');
          console.log('üìä Next step: Ensure database tables exist');
          console.log('');
          console.log('üîß Run this SQL in your Supabase SQL Editor:');
          console.log('https://supabase.com/dashboard/project/dvbbvjlwmkqqyfqdbupg/sql');
          console.log('');
          console.log('Copy the schema from supabase-config.js file');
          console.groupEnd();
        } else {
          console.group('üìã Supabase Setup Issue');
          console.log('‚ùå Supabase client failed to initialize');
          console.log('Check that the Supabase CDN is loaded properly');
          console.groupEnd();
        }
      }
      
      // Test database connection and tables
      async function testDatabaseConnection() {
        if (!supabaseClient) {
          console.log('‚ùå Cannot test database - Supabase client not initialized');
          return;
        }
        
        try {
          console.log('üîç Testing database connection...');
          
          // Test basic connection by checking auth
          const { data: { user } } = await supabaseClient.auth.getUser();
          console.log('‚úÖ Supabase auth connection successful');
          
          // Test if job_seekers table exists
          const { data, error } = await supabaseClient
            .from('job_seekers')
            .select('count')
            .limit(1);
            
          if (error) {
            if (error.message.includes('relation "public.job_seekers" does not exist')) {
              console.log('‚ùå Database tables not created yet');
              console.log('üìã Please run the SQL schema from supabase-config.js');
              
              // Show user-friendly message
              setTimeout(() => {
                alert('‚ö†Ô∏è Database tables not found!\n\nPlease run the SQL schema in your Supabase dashboard.\nCheck the console for instructions.');
              }, 500);
            } else {
              console.log('‚ùå Database error:', error.message);
            }
          } else {
            console.log('‚úÖ Database tables exist and accessible');
          }
        } catch (error) {
          console.error('‚ùå Database test failed:', error);
        }
      }

      // Testing mode configuration
      // Set to false for production
      
      /*
      DATABASE SCHEMA NEEDED FOR THIS REGISTRATION FORM:
      
      1. Create these tables in your Supabase database:
      
      -- Job Seekers Table
      CREATE TABLE job_seekers (
        id UUID PRIMARY KEY REFERENCES auth.users(id),
        email TEXT NOT NULL,
        username TEXT UNIQUE NOT NULL,
        first_name TEXT,
        surname TEXT,
        location TEXT,
        phone TEXT,
        professional_title TEXT,
        travel_distance TEXT,
        willing_to_relocate TEXT,
        years_experience TEXT,
        industry TEXT,
        subscription_tier TEXT,
        selected_jobs TEXT[], -- Array of job types
        skills TEXT[], -- Array of skills
        reference_1_name TEXT,
        reference_1_phone TEXT,
        reference_2_name TEXT,
        reference_2_phone TEXT,
        created_at TIMESTAMP DEFAULT NOW(),
        updated_at TIMESTAMP DEFAULT NOW()
      );
      
      -- Employers Table
      CREATE TABLE employers (
        id UUID PRIMARY KEY REFERENCES auth.users(id),
        email TEXT NOT NULL,
        username TEXT UNIQUE NOT NULL,
        full_name TEXT,
        position_title TEXT,
        phone TEXT,
        employer_type TEXT CHECK (employer_type IN ('business', 'individual')),
        company_name TEXT,
        company_website TEXT,
        industry TEXT,
        company_size TEXT,
        created_at TIMESTAMP DEFAULT NOW(),
        updated_at TIMESTAMP DEFAULT NOW()
      );
      
      2. Create storage buckets for file uploads:
      - job-seeker-files (for resumes, certificates)
      - employer-files (for company logos)
      
      3. Set up Row Level Security (RLS) policies as needed
      */
      
      // Utility functions for Supabase operations
      const SupabaseAuth = {
        async signUp(email, password, userData) {
          try {
            if (!supabaseClient) {
              throw new Error('Supabase client not initialized');
            }
            console.log('üîÑ Attempting to sign up user:', email);
            const { data, error } = await supabaseClient.auth.signUp({
              email: email,
              password: password,
              options: {
                data: userData
              }
            });
            console.log('üì§ Sign up response:', { data, error });
            return { data, error };
          } catch (error) {
            console.error('‚ùå Sign up error:', error);
            return { data: null, error };
          }
        },
        
        async signIn(email, password) {
          try {
            if (!supabaseClient) {
              throw new Error('Supabase client not initialized');
            }
            const { data, error } = await supabaseClient.auth.signInWithPassword({
              email: email,
              password: password
            });
            return { data, error };
          } catch (error) {
            console.error('‚ùå Sign in error:', error);
            return { data: null, error };
          }
        }
      }
      
      const SupabaseDB = {
        async insertJobSeeker(userData) {
          try {
            if (!supabaseClient) {
              throw new Error('Supabase client not initialized');
            }
            console.log('üîÑ Inserting job seeker data:', userData);
            const { data, error } = await supabaseClient
              .from('job_seekers')
              .insert([userData])
              .select();
            console.log('üì§ Job seeker insert response:', { data, error });
            return { data, error };
          } catch (error) {
            console.error('‚ùå Job seeker insert error:', error);
            return { data: null, error };
          }
        },
        
        async insertEmployer(userData) {
          try {
            if (!supabaseClient) {
              throw new Error('Supabase client not initialized');
            }
            console.log('üîÑ Inserting employer data:', userData);
            const { data, error } = await supabaseClient
              .from('employers')
              .insert([userData])
              .select();
            console.log('üì§ Employer insert response:', { data, error });
            return { data, error };
          } catch (error) {
            console.error('‚ùå Employer insert error:', error);
            return { data: null, error };
          }
        },
        
        async uploadFile(bucket, filePath, file) {
          try {
            if (!supabaseClient) {
              throw new Error('Supabase client not initialized');
            }
            console.log('üîÑ Uploading file:', filePath);
            const { data, error } = await supabaseClient.storage
              .from(bucket)
              .upload(filePath, file);
            console.log('üì§ File upload response:', { data, error });
            return { data, error };
          } catch (error) {
            console.error('‚ùå File upload error:', error);
            return { data: null, error };
          }
        }
      }
    </script>
    <style>
      :where([class^="ri-"])::before { content: "\f3c2"; }
      @import url('https://fonts.googleapis.com/css2?family=Futura:wght@400;500;700&display=swap');
      body {
      font-family: 'Futura', sans-serif;
      background-color: #f9fafb;
      }
      .checkbox-container input[type="checkbox"] {
      display: none;
      }
      .checkbox-container .checkbox-custom {
      width: 18px;
      height: 18px;
      border: 2px solid #d1d5db;
      border-radius: 4px;
      position: relative;
      cursor: pointer;
      transition: all 0.2s ease;
      }
      .checkbox-container input[type="checkbox"]:checked + .checkbox-custom {
      background-color: #F50302;
      border-color: #F50302;
      }
      .checkbox-container input[type="checkbox"]:checked + .checkbox-custom::after {
      content: '';
      position: absolute;
      left: 5px;
      top: 2px;
      width: 5px;
      height: 10px;
      border: solid white;
      border-width: 0 2px 2px 0;
      transform: rotate(45deg);
      }
      .social-btn:hover {
      background-color: #f3f4f6;
      }
      .input-container {
      position: relative;
      }
      .input-container input {
      padding-left: 40px;
      }
      .input-container .icon {
      position: absolute;
      left: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #9ca3af;
      }
      .password-toggle {
      position: absolute;
      right: 12px;
      top: 50%;
      transform: translateY(-50%);
      color: #9ca3af;
      cursor: pointer;
      }
      .user-type-card {
      transition: all 0.3s ease;
      cursor: pointer;
      }
      .user-type-card.selected {
      border-color: #F50302;
      background-color: rgba(245, 3, 2, 0.05);
      }
      .user-type-card:hover:not(.selected) {
      border-color: #d1d5db;
      background-color: #f9fafb;
      }
      .employer-type-card {
      transition: all 0.3s ease;
      cursor: pointer;
      }
      .employer-type-card.selected {
      border-color: #F50302;
      background-color: rgba(245, 3, 2, 0.05);
      }
      .employer-type-card:hover:not(.selected) {
      border-color: #d1d5db;
      background-color: #f9fafb;
      }
      .password-strength-meter {
      height: 4px;
      border-radius: 2px;
      margin-top: 6px;
      display: flex;
      overflow: hidden;
      }
      .password-strength-meter div {
      height: 100%;
      width: 25%;
      margin-right: 2px;
      background-color: #e5e7eb;
      }
      .password-strength-meter div:last-child {
      margin-right: 0;
      }
      .password-strength-meter.weak div:nth-child(1) {
      background-color: #ef4444;
      }
      .password-strength-meter.medium div:nth-child(1),
      .password-strength-meter.medium div:nth-child(2) {
      background-color: #f59e0b;
      }
      .password-strength-meter.strong div:nth-child(1),
      .password-strength-meter.strong div:nth-child(2),
      .password-strength-meter.strong div:nth-child(3) {
      background-color: #10b981;
      }
      .password-strength-meter.very-strong div {
      background-color: #10b981;
      }
      .file-upload-container {
      position: relative;
      overflow: hidden;
      }
      .file-upload-container input[type="file"] {
      position: absolute;
      top: 0;
      right: 0;
      min-width: 100%;
      min-height: 100%;
      opacity: 0;
      cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div class="min-h-screen flex flex-col">
      <!-- Header -->
      <header class="bg-white shadow-sm">
        <div
          class="container mx-auto px-4 py-4 flex justify-between items-center"
        >
          <a
            href="login.html"
            class="flex items-center text-gray-800 hover:text-primary"
          >
            <div class="w-6 h-6 flex items-center justify-center mr-2">
              <i class="ri-arrow-left-line"></i>
            </div>
            <span>Back to Login</span>
          </a>
          <div class="text-2xl font-bold tracking-tight flex items-center">
            <img
              src="https://static.readdy.ai/image/783dd8c3d2d1f38f9648f46144ac17f1/bc2b69f3a823a0bfcee48284d9c2d098.jpeg"
              alt="Verify Logo"
              class="h-10"
            />
          </div>
          <div class="w-24">
            <!-- Spacer to balance the header -->
          </div>
        </div>
      </header>
      
      <!-- Testing Mode Indicator -->
      <div id="testingModeIndicator" class="bg-yellow-400 text-yellow-900 px-4 py-2 text-center text-sm font-medium border-b border-yellow-500" style="display: none;">
        <i class="ri-tools-line mr-2"></i>
        <strong>TESTING MODE ENABLED</strong> - Skip payment options available for development
      </div>
      
      <!-- Main Content -->
      <main class="flex-grow flex items-center justify-center px-4 py-12">
        <div class="bg-white rounded-lg shadow-lg p-8 w-full max-w-3xl">
          <div class="text-center mb-8">
            <img
              src="https://static.readdy.ai/image/783dd8c3d2d1f38f9648f46144ac17f1/bc2b69f3a823a0bfcee48284d9c2d098.jpeg"
              alt="Verify Logo"
              class="h-12 mx-auto mb-6"
            />
            <h1 class="text-2xl font-bold text-gray-900">
              Create your Verify account
            </h1>
            <p class="text-gray-600 mt-2">
              Choose your account type to get started
            </p>
          </div>
          <!-- User Type Selection -->
          <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-8">
            <div
              id="jobSeekerCard"
              class="user-type-card border-2 rounded-lg p-6 flex flex-col items-center selected"
            >
              <div
                class="w-16 h-16 bg-red-50 rounded-full flex items-center justify-center mb-4"
              >
                <div
                  class="w-8 h-8 flex items-center justify-center text-primary"
                >
                  <i class="ri-user-search-line ri-2x"></i>
                </div>
              </div>
              <h3 class="text-lg font-semibold mb-2">Job Seeker</h3>
              <p class="text-gray-500 text-center text-sm">
                Find your dream job and connect with top employers
              </p>
            </div>
            <div
              id="employerCard"
              class="user-type-card border-2 border-gray-200 rounded-lg p-6 flex flex-col items-center"
            >
              <div
                class="w-16 h-16 bg-gray-50 rounded-full flex items-center justify-center mb-4"
              >
                <div
                  class="w-8 h-8 flex items-center justify-center text-gray-500"
                >
                  <i class="ri-building-line ri-2x"></i>
                </div>
              </div>
              <h3 class="text-lg font-semibold mb-2">Employer</h3>
              <p class="text-gray-500 text-center text-sm">
                Post jobs and find the perfect candidates for your company
              </p>
            </div>
          </div>
          <!-- Registration Forms Container -->
          <div id="formContainer">
            <!-- Job Seeker Registration Form -->
            <div id="jobSeekerForm" class="block">
              <form
                method="POST"
                id="jobSeekerRegistrationForm"
              >
                <div class="mb-8">
                  <h3 class="text-lg font-medium text-gray-900 mb-4 text-center">
                    Choose Your Verification Tier
                  </h3>
                  <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                    <!-- Bronze Card -->
                    <div
                      class="border border-gray-200 rounded-lg p-6 hover:border-primary cursor-pointer transition-all category-card bg-white flex flex-col"
                    >
                      <div class="flex flex-col items-center text-center mb-8">
                        <div
                          class="w-16 h-16 flex items-center justify-center bg-[#CD7F32] rounded-full mb-4"
                        >
                          <i
                            class="ri-shield-check-line text-white text-2xl"
                          ></i>
                        </div>
                        <h4 class="text-xl font-semibold text-gray-900">
                          Bronze
                        </h4>
                        <p class="text-sm text-gray-500">Basic Verification</p>
                      </div>
                      <div class="text-center mb-6">
                        <p class="text-sm text-gray-600">
                          Contact us for pricing
                        </p>
                      </div>
                      <ul class="space-y-4 mb-6 flex-grow">
                        <li class="flex items-center text-sm text-gray-600">
                          <i
                            class="ri-checkbox-circle-fill text-[#CD7F32] mr-2"
                          ></i>
                          <span>CV Verification</span>
                        </li>
                        <li class="flex items-center text-sm text-gray-400">
                          <i
                            class="ri-close-circle-line text-gray-400 mr-2"
                          ></i>
                          <span>Police Clearance</span>
                        </li>
                        <li class="flex items-center text-sm text-gray-400">
                          <i
                            class="ri-close-circle-line text-gray-400 mr-2"
                          ></i>
                          <span>Polygraph Test</span>
                        </li>
                        <li class="h-6"></li>
                      </ul>
                      <label class="flex items-center justify-center mt-auto">
                        <input
                          type="radio"
                          name="subscription"
                          value="bronze"
                          class="sr-only"
                          checked
                        />
                        <div
                          class="w-6 h-6 border-2 border-gray-300 rounded-full flex items-center justify-center mr-2"
                        >
                          <div
                            class="w-3 h-3 bg-primary rounded-full hidden"
                          ></div>
                        </div>
                        <span class="text-sm text-gray-700">Select Tier</span>
                      </label>
                    </div>
                    <!-- Silver Card -->
                    <div
                      class="border-2 border-gray-200 rounded-lg p-6 hover:border-primary cursor-pointer transition-all category-card bg-white flex flex-col"
                    >
                      <div class="flex flex-col items-center text-center mb-8">
                        <div
                          class="w-16 h-16 flex items-center justify-center bg-[#C0C0C0] rounded-full mb-4"
                        >
                          <i
                            class="ri-shield-check-line text-white text-2xl"
                          ></i>
                        </div>
                        <h4 class="text-xl font-semibold text-gray-900">
                          Silver
                        </h4>
                        <p class="text-sm text-gray-500">
                          Enhanced Verification
                        </p>
                      </div>
                      <div class="text-center mb-6">
                        <p class="text-sm text-gray-600">
                          Contact us for pricing
                        </p>
                      </div>
                      <ul class="space-y-4 mb-6 flex-grow">
                        <li class="flex items-center text-sm text-gray-600">
                          <i
                            class="ri-checkbox-circle-fill text-[#C0C0C0] mr-2"
                          ></i>
                          <span>CV Verification</span>
                        </li>
                        <li class="flex items-center text-sm text-gray-600">
                          <i
                            class="ri-checkbox-circle-fill text-[#C0C0C0] mr-2"
                          ></i>
                          <span>Police Clearance</span>
                        </li>
                        <li class="flex items-center text-sm text-gray-400">
                          <i
                            class="ri-close-circle-line text-gray-400 mr-2"
                          ></i>
                          <span>Polygraph Test</span>
                        </li>
                      </ul>
                      <p class="text-xs text-gray-500 mb-4">
                        Police clearance must be supplied by the job seeker
                      </p>
                      <label class="flex items-center justify-center mt-auto">
                        <input
                          type="radio"
                          name="subscription"
                          value="silver"
                          class="sr-only"
                        />
                        <div
                          class="w-6 h-6 border-2 border-gray-300 rounded-full flex items-center justify-center mr-2"
                        >
                          <div
                            class="w-3 h-3 bg-primary rounded-full hidden"
                          ></div>
                        </div>
                        <span class="text-sm text-gray-700">Select Tier</span>
                      </label>
                    </div>
                    <!-- Gold Card -->
                    <div
                      class="border-2 border-gray-200 rounded-lg p-6 hover:border-primary cursor-pointer transition-all category-card bg-white flex flex-col"
                    >
                      <div class="flex flex-col items-center text-center mb-8">
                        <div
                          class="w-16 h-16 flex items-center justify-center bg-[#FFD700] rounded-full mb-4"
                        >
                          <i
                            class="ri-shield-check-line text-white text-2xl"
                          ></i>
                        </div>
                        <h4 class="text-xl font-semibold text-gray-900">
                          Gold
                        </h4>
                        <p class="text-sm text-gray-500">
                          Premium Verification
                        </p>
                      </div>
                      <div class="text-center mb-6">
                        <p class="text-sm text-gray-600">
                          Contact us for pricing
                        </p>
                      </div>
                      <ul class="space-y-4 mb-6 flex-grow">
                        <li class="flex items-center text-sm text-gray-600">
                          <i
                            class="ri-checkbox-circle-fill text-[#FFD700] mr-2"
                          ></i>
                          <span>CV Verification</span>
                        </li>
                        <li class="flex items-center text-sm text-gray-600">
                          <i
                            class="ri-checkbox-circle-fill text-[#FFD700] mr-2"
                          ></i>
                          <span>Police Clearance</span>
                        </li>
                        <li class="flex items-center text-sm text-gray-600">
                          <i
                            class="ri-checkbox-circle-fill text-[#FFD700] mr-2"
                          ></i>
                          <span>Polygraph Test</span>
                        </li>
                      </ul>
                      <p class="text-xs text-gray-500 mb-4">
                        Police clearance & polygraph must be supplied by the job
                        seeker
                      </p>
                      <label class="flex items-center justify-center mt-auto">
                        <input
                          type="radio"
                          name="subscription"
                          value="gold"
                          class="sr-only"
                        />
                        <div
                          class="w-6 h-6 border-2 border-gray-300 rounded-full flex items-center justify-center mr-2"
                        >
                          <div
                            class="w-3 h-3 bg-primary rounded-full hidden"
                          ></div>
                        </div>
                        <span class="text-sm text-gray-700">Select Tier</span>
                      </label>
                    </div>
                  </div>
                </div>
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-6">
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-user-line"></i>
                    </div>
                    <input
                      type="text"
                      name="firstName"
                      required
                      placeholder="First Name"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-user-line"></i>
                    </div>
                    <input
                      type="text"
                      name="surname"
                      required
                      placeholder="Surname"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-map-pin-line"></i>
                    </div>
                    <input
                      type="text"
                      id="location"
                      name="location"
                      placeholder="Current Location (City, Province)"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-route-line"></i>
                    </div>
                    <select
                      id="travelDistance"
                      name="travelDistance"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm pl-10 pr-8 appearance-none"
                    >
                      <option value="">Maximum Travel Distance</option>
                      <option value="5">Up to 5 km</option>
                      <option value="10">Up to 10 km</option>
                      <option value="20">Up to 20 km</option>
                      <option value="30">Up to 30 km</option>
                      <option value="50">Up to 50 km</option>
                      <option value="100">Up to 100 km</option>
                    </select>
                    <div
                      class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                    >
                      <i class="ri-arrow-down-s-line"></i>
                    </div>
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-home-4-line"></i>
                    </div>
                    <select
                      id="willRelocate"
                      name="willRelocate"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm pl-10 pr-8 appearance-none"
                    >
                      <option value="">Willing to Relocate?</option>
                      <option value="yes">Yes, anywhere in South Africa</option>
                      <option value="limited">Yes, within my province</option>
                      <option value="no">No, only local opportunities</option>
                    </select>
                    <div
                      class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                    >
                      <i class="ri-arrow-down-s-line"></i>
                    </div>
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-mail-line"></i>
                    </div>
                    <input
                      type="email"
                      id="email"
                      name="email"
                      required
                      placeholder="Email Address"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-phone-line"></i>
                    </div>
                    <input
                      type="tel"
                      id="phone"
                      name="phone"
                      placeholder="Phone Number (Optional)"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-briefcase-line"></i>
                    </div>
                    <input
                      type="text"
                      id="professionalTitle"
                      name="professionalTitle"
                      placeholder="Professional Title"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-user-3-line"></i>
                    </div>
                    <input
                      type="text"
                      id="username"
                      name="username"
                      required
                      placeholder="Username"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-time-line"></i>
                    </div>
                    <select
                      id="experience"
                      name="experience"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm pl-10 pr-8 appearance-none"
                    >
                      <option value="">Years of Experience</option>
                      <option value="0-1">0-1 years</option>
                      <option value="1-3">1-3 years</option>
                      <option value="3-5">3-5 years</option>
                      <option value="5-10">5-10 years</option>
                      <option value="10+">10+ years</option>
                    </select>
                    <div
                      class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                    >
                      <i class="ri-arrow-down-s-line"></i>
                    </div>
                  </div>
                </div>
                <div class="mb-6">
                  <label class="block text-sm font-medium text-gray-700 mb-2"
                    >References</label
                  >
                  <div class="space-y-4">
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div class="input-container">
                        <div
                          class="icon w-5 h-5 flex items-center justify-center"
                        >
                          <i class="ri-user-line"></i>
                        </div>
                        <input
                          type="text"
                          name="reference1_name"
                          placeholder="Reference Name"
                          class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                        />
                      </div>
                      <div class="input-container">
                        <div
                          class="icon w-5 h-5 flex items-center justify-center"
                        >
                          <i class="ri-phone-line"></i>
                        </div>
                        <input
                          type="tel"
                          name="reference1_phone"
                          placeholder="Reference Phone Number"
                          class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                        />
                      </div>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                      <div class="input-container">
                        <div
                          class="icon w-5 h-5 flex items-center justify-center"
                        >
                          <i class="ri-user-line"></i>
                        </div>
                        <input
                          type="text"
                          name="reference2_name"
                          placeholder="Reference Name (Optional)"
                          class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                        />
                      </div>
                      <div class="input-container">
                        <div
                          class="icon w-5 h-5 flex items-center justify-center"
                        >
                          <i class="ri-phone-line"></i>
                        </div>
                        <input
                          type="tel"
                          name="reference2_phone"
                          placeholder="Reference Phone Number (Optional)"
                          class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                        />
                      </div>
                    </div>
                  </div>
                </div>
                <div class="mb-6">
                  <label class="block text-sm font-medium text-gray-700 mb-2"
                    >Upload Resume (Optional)</label
                  >
                  <div
                    class="file-upload-container flex items-center justify-center w-full border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-primary transition-colors"
                  >
                    <div class="text-center">
                      <div
                        class="w-12 h-12 mx-auto bg-gray-50 rounded-full flex items-center justify-center mb-3"
                      >
                        <div
                          class="w-6 h-6 flex items-center justify-center text-gray-400"
                        >
                          <i class="ri-upload-2-line"></i>
                        </div>
                      </div>
                      <p class="text-sm text-gray-600">
                        Drag and drop your resume here or
                        <span class="text-primary">browse files</span>
                      </p>
                      <p class="text-xs text-gray-500 mt-1">
                        PDF, DOCX or RTF (Max 5MB)
                      </p>
                      <input type="file" accept=".pdf,.docx,.rtf" />
                    </div>
                  </div>
                </div>
                <div class="space-y-5 mb-6">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2"
                      >Industry Preferences</label
                    >
                    <div class="input-container">
                      <div
                        class="icon w-5 h-5 flex items-center justify-center"
                      >
                        <i class="ri-building-4-line"></i>
                      </div>
                      <select
                        id="industrySelect"
                        name="industry"
                        required
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary text-sm pl-10 pr-8 appearance-none"
                      >
                        <option value="">Select an Industry Sector</option>
                        <option value="drivers">Drivers</option>
                        <option value="domestic_workers">Domestic Workers</option>
                        <option value="child_elder_care">Child & Elder Care</option>
                        <option value="security">Security Services</option>
                        <option value="trades">Skilled Trades</option>
                        <option value="construction">Construction</option>
                        <option value="retail_hospitality">Retail & Hospitality</option>
                        <option value="admin">Administrative & Office</option>
                        <option value="warehouse">Warehouse & Logistics</option>
                        <option value="event_staff">Event Staff</option>
                        <option value="mechanics">Truck & Vehicle Mechanics</option>
                        <option value="agriculture_farm_work">Agriculture & Farm Work</option>
                      </select>
                      <div
                        class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                      >
                        <i class="ri-arrow-down-s-line"></i>
                      </div>
                    </div>
                  </div>
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2"
                      >Job Positions</label
                    >
                    <div
                      id="selectedJobs"
                      class="flex flex-wrap gap-2 mb-3"
                    ></div>
                    <div class="input-container">
                      <div
                        class="icon w-5 h-5 flex items-center justify-center"
                      >
                        <i class="ri-briefcase-line"></i>
                      </div>
                      <select
                        id="jobSelect"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm pl-10 pr-8 appearance-none"
                      >
                        <option value="">Select Position</option>
                      </select>
                      <div
                        class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                      >
                        <i class="ri-arrow-down-s-line"></i>
                      </div>
                    </div>
                  </div>
                  <div class="mb-6">
                    <label class="block text-sm font-medium text-gray-700 mb-2"
                      >Skills</label
                    >
                    <div class="border border-gray-300 rounded p-3">
                      <div class="flex flex-wrap gap-2 mb-2" id="skillTags">
                        <div
                          class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center"
                        >
                          Safe Driving
                          <button
                            type="button"
                            class="ml-1 text-gray-500 hover:text-gray-700"
                          >
                            <i class="ri-close-line"></i>
                          </button>
                        </div>
                        <div
                          class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center"
                        >
                          Time Management
                          <button
                            type="button"
                            class="ml-1 text-gray-500 hover:text-gray-700"
                          >
                            <i class="ri-close-line"></i>
                          </button>
                        </div>
                        <div
                          class="bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center"
                        >
                          Customer Service
                          <button
                            type="button"
                            class="ml-1 text-gray-500 hover:text-gray-700"
                          >
                            <i class="ri-close-line"></i>
                          </button>
                        </div>
                      </div>
                      <input
                        type="text"
                        id="skillInput"
                        placeholder="Add relevant skills (e.g., Safe Driving, Customer Service)"
                        class="w-full border-none focus:ring-0 text-sm p-1"
                      />
                    </div>
                  </div>
                  <div class="mb-6">
                    <button
                      type="button"
                      id="cleanRecordBtn"
                      class="w-full flex items-center justify-center py-3 px-4 border border-gray-300 !rounded-button hover:bg-gray-50 transition-colors gap-2"
                    >
                      <i class="ri-shield-check-line text-primary"></i>
                      <span class="text-gray-700"
                        >Click here to verify your clean record</span
                      >
                      <i class="ri-arrow-right-line text-gray-400"></i>
                    </button>
                    <div
                      id="cleanRecordModal"
                      class="hidden fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50"
                    >
                      <div class="bg-white rounded-lg p-6 max-w-md w-full mx-4">
                        <div class="flex justify-between items-center mb-4">
                          <h3 class="text-lg font-medium text-gray-900">
                            Clean Record Verification
                          </h3>
                          <button
                            type="button"
                            class="text-gray-400 hover:text-gray-500"
                            id="closeModal"
                          >
                            <i class="ri-close-line text-xl"></i>
                          </button>
                        </div>
                        <p class="text-gray-600 mb-4">
                          Please upload your police clearance certificate or
                          other relevant documentation to verify your clean
                          record.
                        </p>
                        <div class="file-upload-container mb-4">
                          <div
                            class="border-2 border-dashed border-gray-300 rounded-lg p-4 text-center hover:border-primary transition-colors"
                          >
                            <div
                              class="w-12 h-12 mx-auto bg-gray-50 rounded-full flex items-center justify-center mb-3"
                            >
                              <i
                                class="ri-upload-2-line text-gray-400 text-xl"
                              ></i>
                            </div>
                            <p class="text-sm text-gray-600">
                              Drag and drop your documents here or
                              <span class="text-primary">browse files</span>
                            </p>
                            <p class="text-xs text-gray-500 mt-1">
                              PDF or image files (Max 5MB)
                            </p>
                            <input
                              type="file"
                              accept=".pdf,.jpg,.jpeg,.png"
                              class="opacity-0 absolute inset-0 w-full h-full cursor-pointer"
                            />
                          </div>
                        </div>
                        <div class="flex justify-end gap-3">
                          <button
                            type="button"
                            class="border border-gray-300 text-gray-700 px-4 py-2 !rounded-button hover:bg-gray-50 transition-colors"
                            id="submitLaterBtn"
                          >
                            Submit Later
                          </button>
                          <button
                            type="button"
                            class="bg-primary text-white px-4 py-2 !rounded-button hover:bg-red-600 transition-colors"
                          >
                            Submit for Verification
                          </button>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="space-y-5">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2"
                      >Password</label
                    >
                    <div class="input-container">
                      <div
                        class="icon w-5 h-5 flex items-center justify-center"
                      >
                        <i class="ri-lock-line"></i>
                      </div>
                      <input
                        type="password"
                        id="seekerPassword"
                        name="password"
                        required
                        placeholder="Create a password"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                      />
                      <div
                        class="password-toggle w-5 h-5 flex items-center justify-center"
                        id="toggleSeekerPassword"
                      >
                        <i class="ri-eye-line"></i>
                      </div>
                    </div>
                    <div
                      class="password-strength-meter mt-2"
                      id="seekerPasswordStrength"
                    >
                      <div></div>
                      <div></div>
                      <div></div>
                      <div></div>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                      Password strength:
                      <span id="seekerPasswordStrengthText">Weak</span>
                    </p>
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-lock-line"></i>
                    </div>
                    <input
                      type="password"
                      id="confirmPassword"
                      name="confirmPassword"
                      required
                      placeholder="Confirm password"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="flex items-start">
                    <label class="flex items-start checkbox-container" title="Click to read and accept Terms & Conditions">
                      <input type="checkbox" id="seekerTerms" required />
                      <div class="checkbox-custom mt-1"></div>
                      <span class="ml-2 text-sm text-gray-700"
                        >I agree to the
                        <a href="#" onclick="openModal('termsModal')" class="text-primary hover:underline"
                          >Terms of Service</a
                        >
                        and
                        <a href="#" onclick="openModal('privacyModal')" class="text-primary hover:underline"
                          >Privacy Policy</a
                        >
                        <span class="text-red-500">*</span>
                        <span class="text-xs text-gray-500 block mt-1">
                          üí° Click the checkbox to read and accept our terms
                        </span>
                      </span>
                    </label>
                  </div>
                  <div class="space-y-3">
                    <div class="flex items-center justify-between text-sm mb-2">
                      <span class="font-medium text-gray-900"
                        >Total Amount:</span
                      >
                      <div class="flex items-center">
                        <span
                          class="font-bold text-lg text-gray-900"
                          id="totalAmount"
                          >R 0.00</span
                        >
                        <span class="text-gray-500 ml-1">/monthly</span>
                      </div>
                    </div>
                    <button
                      type="submit"
                      id="jobSeekerSubmit"
                      class="w-full bg-primary text-white py-3 !rounded-button font-medium hover:bg-red-600 transition-colors whitespace-nowrap flex items-center justify-center"
                    >
                      <i class="ri-secure-payment-line mr-2"></i>
                      Pay & Create Account
                    </button>
                    <p class="text-xs text-gray-500 text-center">
                      Secure payment powered by Stripe
                    </p>
                  </div>
                </div>
              </form>
              <div class="relative flex items-center justify-center my-6">
                <div class="border-t border-gray-300 absolute w-full"></div>
                <span class="bg-white px-4 text-sm text-gray-500 relative"
                  >or</span
                >
              </div>
              <div class="space-y-3">
                <button
                  class="social-btn w-full flex items-center justify-center py-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"
                >
                  <div class="w-5 h-5 flex items-center justify-center mr-3">
                    <i class="ri-google-fill text-[#4285F4]"></i>
                  </div>
                  <span class="text-sm font-medium">Continue with Google</span>
                </button>
                <button
                  class="social-btn w-full flex items-center justify-center py-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"
                >
                  <div class="w-5 h-5 flex items-center justify-center mr-3">
                    <i class="ri-facebook-fill text-[#1877F2]"></i>
                  </div>
                  <span class="text-sm font-medium"
                    >Continue with Facebook</span
                  >
                </button>
              </div>
              
              <!-- Job Seeker Login Link -->
              <div class="text-center mt-6">
                <p class="text-gray-600">
                  Already have an account?
                  <a href="login.html" class="text-primary hover:underline">Log in</a>
                </p>
              </div>
            </div>
            
            <!-- Employer Registration Form -->
            <div id="employerForm" class="hidden">
              <form
                method="POST"
                id="employerRegistrationForm"
              >
                <div class="mb-6">
                  <h3 class="text-lg font-medium text-gray-900 mb-4">
                    Account Type
                  </h3>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-4 mb-6">
                    <div class="border rounded-lg p-4 cursor-pointer hover:border-primary transition-colors employer-type-card" data-type="business">
                      <div class="flex items-center mb-2">
                        <div class="w-4 h-4 border-2 border-gray-300 rounded-full mr-3 radio-indicator"></div>
                        <h4 class="font-medium">Business/Company</h4>
                      </div>
                      <p class="text-sm text-gray-500">Register as a business entity with company details</p>
                    </div>
                    <div class="border rounded-lg p-4 cursor-pointer hover:border-primary transition-colors employer-type-card selected" data-type="individual">
                      <div class="flex items-center mb-2">
                        <div class="w-4 h-4 border-2 border-primary bg-primary rounded-full mr-3 radio-indicator flex items-center justify-center">
                          <div class="w-2 h-2 bg-white rounded-full"></div>
                        </div>
                        <h4 class="font-medium">Private Individual</h4>
                      </div>
                      <p class="text-sm text-gray-500">Register as a private person looking to hire</p>
                    </div>
                  </div>
                </div>
                
                <!-- Business Details Section (Optional) -->
                <div id="businessDetailsSection" class="mb-6 hidden">
                  <h3 class="text-md font-medium text-gray-700 mb-3">
                    Business Details <span class="text-gray-500 text-sm">(Optional for businesses)</span>
                  </h3>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-4">
                    <div class="input-container">
                      <div class="icon w-5 h-5 flex items-center justify-center">
                        <i class="ri-building-line"></i>
                      </div>
                      <input
                        type="text"
                        placeholder="Company Name (Optional)"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                      />
                    </div>
                    <div class="input-container">
                      <div class="icon w-5 h-5 flex items-center justify-center">
                        <i class="ri-global-line"></i>
                      </div>
                      <input
                        type="url"
                        placeholder="Company Website (Optional)"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                      />
                    </div>
                    <div class="input-container">
                      <div class="icon w-5 h-5 flex items-center justify-center">
                        <i class="ri-building-4-line"></i>
                      </div>
                      <select
                        id="industry"
                        name="industry"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm pl-10 pr-8 appearance-none"
                      >
                        <option value="">Select an Industry Sector (Optional)</option>
                        <option value="drivers">Drivers</option>
                        <option value="domestic_workers">Domestic Workers</option>
                        <option value="child_elder_care">Child & Elder Care</option>
                        <option value="security">Security</option>
                        <option value="trades">Trades</option>
                        <option value="construction">Construction</option>
                        <option value="retail_hospitality">Retail & Hospitality</option>
                        <option value="admin">Admin</option>
                        <option value="warehouse">Warehouse</option>
                        <option value="event_staff">Event Staff</option>
                        <option value="truck_mechanics">Truck Mechanics</option>
                        <option value="agriculture_farm_work">Agriculture &amp; Farm Work</option>
                      </select>
                      <div
                        class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                      >
                        <i class="ri-arrow-down-s-line"></i>
                      </div>
                    </div>
                    <div class="input-container">
                      <div class="icon w-5 h-5 flex items-center justify-center">
                        <i class="ri-team-line"></i>
                      </div>
                      <select
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm pl-10 pr-8 appearance-none"
                      >
                        <option value="">Company Size (Optional)</option>
                        <option value="1-10">1-10 employees</option>
                        <option value="11-50">11-50 employees</option>
                        <option value="51-200">51-200 employees</option>
                        <option value="201-500">201-500 employees</option>
                        <option value="501-1000">501-1000 employees</option>
                        <option value="1001+">1001+ employees</option>
                      </select>
                      <div
                        class="absolute right-3 top-1/2 transform -translate-y-1/2 pointer-events-none"
                      >
                        <i class="ri-arrow-down-s-line"></i>
                      </div>
                    </div>
                  </div>
                </div>
                
                <!-- Primary Contact Details -->
                <div class="grid grid-cols-1 md:grid-cols-2 gap-5 mb-6">
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-mail-line"></i>
                    </div>
                    <input
                      type="email"
                      placeholder="Email Address"
                      required
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-user-3-line"></i>
                    </div>
                    <input
                      type="text"
                      placeholder="Username"
                      required
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                </div>
                
                <div class="mb-6">
                  <h3 class="text-md font-medium text-gray-700 mb-3">
                    Contact Person Details
                  </h3>
                  <div class="grid grid-cols-1 md:grid-cols-2 gap-5">
                    <div class="input-container">
                      <div
                        class="icon w-5 h-5 flex items-center justify-center"
                      >
                        <i class="ri-user-line"></i>
                      </div>
                      <input
                        type="text"
                        placeholder="Full Name"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                      />
                    </div>
                    <div class="input-container">
                      <div
                        class="icon w-5 h-5 flex items-center justify-center"
                      >
                        <i class="ri-briefcase-line"></i>
                      </div>
                      <input
                        type="text"
                        placeholder="Position/Title"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                      />
                    </div>
                    <div class="input-container">
                      <div
                        class="icon w-5 h-5 flex items-center justify-center"
                      >
                        <i class="ri-phone-line"></i>
                      </div>
                      <input
                        type="tel"
                        placeholder="Phone Number"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                      />
                    </div>
                  </div>
                </div>
                <div class="mb-6">
                  <label class="block text-sm font-medium text-gray-700 mb-2"
                    >Company Logo (Optional)</label
                  >
                  <div
                    class="file-upload-container flex items-center justify-center w-full border-2 border-dashed border-gray-300 rounded-lg p-6 hover:border-primary transition-colors"
                  >
                    <div class="text-center">
                      <div
                        class="w-12 h-12 mx-auto bg-gray-50 rounded-full flex items-center justify-center mb-3"
                      >
                        <div
                          class="w-6 h-6 flex items-center justify-center text-gray-400"
                        >
                          <i class="ri-image-line"></i>
                        </div>
                      </div>
                      <p class="text-sm text-gray-600">
                        Drag and drop your logo here or
                        <span class="text-primary">browse files</span>
                      </p>
                      <p class="text-xs text-gray-500 mt-1">
                        PNG, JPG or SVG (Max 2MB)
                      </p>
                      <input type="file" accept=".png,.jpg,.jpeg,.svg" />
                    </div>
                  </div>
                </div>
                <div class="space-y-5">
                  <div>
                    <label class="block text-sm font-medium text-gray-700 mb-2"
                      >Password</label
                    >
                    <div class="input-container">
                      <div
                        class="icon w-5 h-5 flex items-center justify-center"
                      >
                        <i class="ri-lock-line"></i>
                      </div>
                      <input
                        type="password"
                        id="employerPassword"
                        placeholder="Create a password"
                        class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                      />
                      <div
                        class="password-toggle w-5 h-5 flex items-center justify-center"
                        id="toggleEmployerPassword"
                      >
                        <i class="ri-eye-line"></i>
                      </div>
                    </div>
                    <div
                      class="password-strength-meter mt-2"
                      id="employerPasswordStrength"
                    >
                      <div></div>
                      <div></div>
                      <div></div>
                      <div></div>
                    </div>
                    <p class="text-xs text-gray-500 mt-1">
                      Password strength:
                      <span id="employerPasswordStrengthText">Weak</span>
                    </p>
                  </div>
                  <div class="input-container">
                    <div class="icon w-5 h-5 flex items-center justify-center">
                      <i class="ri-lock-line"></i>
                    </div>
                    <input
                      type="password"
                      placeholder="Confirm password"
                      class="w-full px-4 py-3 border border-gray-300 rounded focus:outline-none focus:ring-2 focus:ring-primary focus:border-transparent text-sm"
                    />
                  </div>
                  <div class="flex items-start">
                    <label class="flex items-start checkbox-container" title="Click to read and accept Terms & Conditions">
                      <input type="checkbox" id="employerTerms" required />
                      <div class="checkbox-custom mt-1"></div>
                      <span class="ml-2 text-sm text-gray-700"
                        >I agree to the
                        <a href="#" onclick="openModal('termsModal')" class="text-primary hover:underline"
                          >Terms of Service</a
                        >
                        and
                        <a href="#" onclick="openModal('privacyModal')" class="text-primary hover:underline"
                          >Privacy Policy</a
                        >
                        <span class="text-red-500">*</span>
                        <span class="text-xs text-gray-500 block mt-1">
                          üí° Click the checkbox to read and accept our terms
                        </span>
                      </span>
                    </label>
                  </div>
                  <button
                    type="button"
                    onclick="openPaymentPortal()"
                    class="w-full bg-primary text-white py-3 !rounded-button font-medium hover:bg-red-600 transition-colors whitespace-nowrap"
                  >
                    Create Employer Account
                  </button>
                </div>
              </form>
              <div class="relative flex items-center justify-center my-6">
                <div class="border-t border-gray-300 absolute w-full"></div>
                <span class="bg-white px-4 text-sm text-gray-500 relative"
                  >or</span
                >
              </div>
              <div class="space-y-3">
                <button
                  class="social-btn w-full flex items-center justify-center py-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"
                >
                  <div class="w-5 h-5 flex items-center justify-center mr-3">
                    <i class="ri-google-fill text-[#4285F4]"></i>
                  </div>
                  <span class="text-sm font-medium">Continue with Google</span>
                </button>
                <button
                  class="social-btn w-full flex items-center justify-center py-3 border border-gray-300 rounded-md hover:bg-gray-50 transition-colors"
                >
                  <div class="w-5 h-5 flex items-center justify-center mr-3">
                    <i class="ri-facebook-fill text-[#1877F2]"></i>
                  </div>
                  <span class="text-sm font-medium"
                    >Continue with Facebook</span
                  >
                </button>
              </div>
              
              <!-- Employer Login Link -->
              <div class="text-center mt-6">
                <p class="text-gray-600">
                  Already have an account?
                  <a href="login.html" class="text-primary hover:underline">Log in</a>
                </p>
              </div>
            </div>
          </div>
        </div>
      </main>
      <!-- Footer -->
      <footer class="bg-white py-6 border-t border-gray-200">
        <div class="container mx-auto px-4">
          <div class="flex flex-col md:flex-row justify-between items-center">
            <p class="text-gray-600 text-sm mb-4 md:mb-0">
              &copy; 2025 Verify. All rights reserved.
            </p>
            <div class="flex space-x-6">
              <a href="#" onclick="openModal('privacyModal')" class="text-gray-600 text-sm hover:text-primary"
                >Privacy Policy</a
              >
              <a href="#" onclick="openModal('termsModal')" class="text-gray-600 text-sm hover:text-primary"
                >Terms of Service</a
              >
              <a href="#" class="text-gray-600 text-sm hover:text-primary"
                >Help Center</a
              >
            </div>
          </div>
        </div>
      </footer>
    </div>
    <script id="user-type-toggle-script">
      document.addEventListener("DOMContentLoaded", function () {
        const jobSeekerCard = document.getElementById("jobSeekerCard");
        const employerCard = document.getElementById("employerCard");
        const jobSeekerFormDiv = document.getElementById("jobSeekerForm");
        const employerFormDiv = document.getElementById("employerForm");
        if (jobSeekerCard && employerCard && jobSeekerFormDiv && employerFormDiv) {
          jobSeekerCard.addEventListener("click", function () {
            jobSeekerCard.classList.add("selected");
            employerCard.classList.remove("selected");
            jobSeekerFormDiv.classList.remove("hidden");
            jobSeekerFormDiv.classList.add("block");
            employerFormDiv.classList.add("hidden");
            employerFormDiv.classList.remove("block");
            // Update icon colors
            const jobSeekerIcon = jobSeekerCard.querySelector(".w-8.h-8");
            const employerIcon = employerCard.querySelector(".w-8.h-8");
            if (jobSeekerIcon && employerIcon) {
              jobSeekerIcon.classList.remove("text-gray-500");
              jobSeekerIcon.classList.add("text-primary");
              employerIcon.classList.remove("text-primary");
              employerIcon.classList.add("text-gray-500");
            }
            // Update background colors
            const jobSeekerBg = jobSeekerCard.querySelector(".w-16.h-16");
            const employerBg = employerCard.querySelector(".w-16.h-16");
            if (jobSeekerBg && employerBg) {
              jobSeekerBg.classList.remove("bg-gray-50");
              jobSeekerBg.classList.add("bg-red-50");
              employerBg.classList.remove("bg-red-50");
              employerBg.classList.add("bg-gray-50");
            }
          });
          employerCard.addEventListener("click", function () {
            employerCard.classList.add("selected");
            jobSeekerCard.classList.remove("selected");
            employerFormDiv.classList.remove("hidden");
            employerFormDiv.classList.add("block");
            jobSeekerFormDiv.classList.add("hidden");
            jobSeekerFormDiv.classList.remove("block");
            // Update icon colors
            const jobSeekerIcon = jobSeekerCard.querySelector(".w-8.h-8");
            const employerIcon = employerCard.querySelector(".w-8.h-8");
            if (jobSeekerIcon && employerIcon) {
              employerIcon.classList.remove("text-gray-500");
              employerIcon.classList.add("text-primary");
              jobSeekerIcon.classList.remove("text-primary");
              jobSeekerIcon.classList.add("text-gray-500");
            }
            // Update background colors
            const jobSeekerBg = jobSeekerCard.querySelector(".w-16.h-16");
            const employerBg = employerCard.querySelector(".w-16.h-16");
            if (jobSeekerBg && employerBg) {
              employerBg.classList.remove("bg-gray-50");
              employerBg.classList.add("bg-red-50");
              jobSeekerBg.classList.remove("bg-red-50");
              jobSeekerBg.classList.add("bg-gray-50");
            }
          });
        }
      });
    </script>
    <script id="password-toggle-script">
      document.addEventListener("DOMContentLoaded", function () {
        const toggleSeekerPassword = document.getElementById("toggleSeekerPassword");
        const seekerPassword = document.getElementById("seekerPassword");
        const toggleEmployerPassword = document.getElementById(
          "toggleEmployerPassword",
        );
        const employerPassword = document.getElementById("employerPassword");
        if (toggleSeekerPassword && seekerPassword) {
          toggleSeekerPassword.addEventListener("click", function () {
            const type =
              seekerPassword.getAttribute("type") === "password"
                ? "text"
                : "password";
            seekerPassword.setAttribute("type", type);
            const icon = toggleSeekerPassword.querySelector("i");
            if (icon) {
              icon.className =
                type === "password" ? "ri-eye-line" : "ri-eye-off-line";
            }
          });
        }
        if (toggleEmployerPassword && employerPassword) {
          toggleEmployerPassword.addEventListener("click", function () {
            const type =
              employerPassword.getAttribute("type") === "password"
                ? "text"
                : "password";
            employerPassword.setAttribute("type", type);
            const icon = toggleEmployerPassword.querySelector("i");
            if (icon) {
              icon.className =
                type === "password" ? "ri-eye-line" : "ri-eye-off-line";
            }
          });
        }
      });
    </script>
    <script id="password-strength-script">
      document.addEventListener("DOMContentLoaded", function () {
        const seekerPassword = document.getElementById("seekerPassword");
        const seekerPasswordStrength = document.getElementById(
          "seekerPasswordStrength",
        );
        const seekerPasswordStrengthText = document.getElementById(
          "seekerPasswordStrengthText",
        );
        const employerPassword = document.getElementById("employerPassword");
        const employerPasswordStrength = document.getElementById(
          "employerPasswordStrength",
        );
        const employerPasswordStrengthText = document.getElementById(
          "employerPasswordStrengthText",
        );
        function checkPasswordStrength(password) {
          let strength = 0;
          if (password.length >= 8) strength += 1;
          if (password.match(/[a-z]/) && password.match(/[A-Z]/)) strength += 1;
          if (password.match(/\d/)) strength += 1;
          if (password.match(/[^a-zA-Z\d]/)) strength += 1;
          return strength;
        }
        function updatePasswordStrengthUI(password, strengthMeter, strengthText) {
          const strength = checkPasswordStrength(password);
          strengthMeter.className = "password-strength-meter mt-2";
          if (strength === 0) {
            strengthMeter.classList.add("weak");
            strengthText.textContent = "Weak";
          } else if (strength === 1) {
            strengthMeter.classList.add("weak");
            strengthText.textContent = "Weak";
          } else if (strength === 2) {
            strengthMeter.classList.add("medium");
            strengthText.textContent = "Medium";
          } else if (strength === 3) {
            strengthMeter.classList.add("strong");
            strengthText.textContent = "Strong";
          } else {
            strengthMeter.classList.add("very-strong");
            strengthText.textContent = "Very Strong";
          }
        }
        if (seekerPassword && seekerPasswordStrength && seekerPasswordStrengthText) {
          seekerPassword.addEventListener("input", function () {
            updatePasswordStrengthUI(
              this.value,
              seekerPasswordStrength,
              seekerPasswordStrengthText,
            );
          });
        }
        if (
          employerPassword &&
          employerPasswordStrength &&
          employerPasswordStrengthText
        ) {
          employerPassword.addEventListener("input", function () {
            updatePasswordStrengthUI(
              this.value,
              employerPasswordStrength,
              employerPasswordStrengthText,
            );
          });
        }
      });
    </script>
    <script id="checkbox-script">
      document.addEventListener("DOMContentLoaded", function () {
        const checkboxContainers = document.querySelectorAll(".checkbox-container");
        checkboxContainers.forEach((container) => {
          const checkbox = container.querySelector('input[type="checkbox"]');
          if (container && checkbox) {
            // Special handling for terms checkboxes
            if (checkbox.id === 'seekerTerms' || checkbox.id === 'employerTerms') {
              container.addEventListener("click", function (e) {
                e.preventDefault(); // Prevent default checkbox behavior
                
                // If checkbox is already checked, uncheck it
                if (checkbox.checked) {
                  checkbox.checked = false;
                  console.log('üìã Terms unchecked');
                  return;
                }
                
                // If not checked, show terms modal first
                console.log('üìã Opening terms modal for user to read and accept');
                openModal('termsModal');
              });
              
              // Also handle direct checkbox clicks
              checkbox.addEventListener("click", function (e) {
                e.preventDefault();
                
                // If trying to check, show modal instead
                if (!checkbox.checked) {
                  console.log('üìã Terms checkbox clicked - opening modal');
                  openModal('termsModal');
                }
              });
            } else {
              // Normal checkbox behavior for other checkboxes
              container.addEventListener("click", function (e) {
                if (e.target !== checkbox) {
                  checkbox.checked = !checkbox.checked;
                }
              });
            }
          }
        });
        
        const subscriptionCards = document.querySelectorAll(".category-card");
        const subscriptionRadios = document.querySelectorAll(
          'input[name="subscription"]',
        );
        if (subscriptionCards && subscriptionCards.length > 0) {
          subscriptionCards.forEach((card, index) => {
            if (!card) return;
            card.addEventListener("click", () => {
              if (subscriptionRadios && subscriptionRadios[index]) {
                subscriptionRadios[index].checked = true;
                updateSubscriptionSelection();
              }
            });
          });
        }
        subscriptionRadios.forEach((radio, index) => {
          radio.addEventListener("change", () => {
            updateSubscriptionSelection();
          });
        });
        function updateSubscriptionSelection() {
          if (!subscriptionCards || !subscriptionRadios) return;
          subscriptionCards.forEach((card, index) => {
            const radio = subscriptionRadios[index];
            const indicator = card.querySelector(".w-3.h-3");
            if (!radio || !indicator) return;
            if (radio.checked) {
              card.classList.add("border-primary");
              card.classList.add("bg-red-50");
              indicator.classList.remove("hidden");
            } else {
              card.classList.remove("border-primary");
              card.classList.remove("bg-red-50");
              indicator.classList.add("hidden");
            }
          });
        }
        updateSubscriptionSelection();
      });
    </script>
    <script id="employer-type-toggle-script">
      document.addEventListener("DOMContentLoaded", function () {
        const employerTypeCards = document.querySelectorAll(".employer-type-card");
        const businessDetailsSection = document.getElementById("businessDetailsSection");
        
        employerTypeCards.forEach((card) => {
          card.addEventListener("click", function() {
            // Remove selected class from all cards
            employerTypeCards.forEach((c) => {
              c.classList.remove("selected");
              const indicator = c.querySelector(".radio-indicator");
              indicator.classList.remove("border-primary", "bg-primary");
              indicator.classList.add("border-gray-300");
              indicator.innerHTML = "";
            });
            
            // Add selected class to clicked card
            this.classList.add("selected");
            const indicator = this.querySelector(".radio-indicator");
            indicator.classList.remove("border-gray-300");
            indicator.classList.add("border-primary", "bg-primary");
            indicator.innerHTML = '<div class="w-2 h-2 bg-white rounded-full"></div>';
            
            // Show/hide business details based on selection
            const employerType = this.getAttribute("data-type");
            if (employerType === "business") {
              businessDetailsSection.classList.remove("hidden");
            } else {
              businessDetailsSection.classList.add("hidden");
            }
          });
        });
      });
    </script>
    <script id="form-submission-script">
      document.addEventListener("DOMContentLoaded", function () {
        const jobSeekerFormDiv = document.getElementById("jobSeekerForm");
        const employerFormDiv = document.getElementById("employerForm");
        const cleanRecordBtn = document.getElementById("cleanRecordBtn");
        const cleanRecordModal = document.getElementById("cleanRecordModal");
        const closeModal = document.getElementById("closeModal");
        const submitLaterBtn = document.getElementById("submitLaterBtn");
        if (cleanRecordBtn && cleanRecordModal && closeModal && submitLaterBtn) {
          submitLaterBtn.addEventListener("click", function () {
            cleanRecordModal.classList.add("hidden");
          });
          cleanRecordBtn.addEventListener("click", function () {
            cleanRecordModal.classList.remove("hidden");
          });
          closeModal.addEventListener("click", function () {
            cleanRecordModal.classList.add("hidden");
          });
          cleanRecordModal.addEventListener("click", function (e) {
            if (e.target === cleanRecordModal) {
              cleanRecordModal.classList.add("hidden");
            }
          });
        }
        function validateForm(form) {
          let isValid = true;
          const errorMessages = [];
          // Check required fields
          const requiredFields = form.querySelectorAll(
            "input[required], select[required]",
          );
          requiredFields.forEach((field) => {
            if (!field.value.trim()) {
              isValid = false;
              field.classList.add("border-red-500");
              errorMessages.push(
                `${field.placeholder || "Required field"} is required`,
              );
            } else {
              field.classList.remove("border-red-500");
            }
          });
          // Validate password
          const passwordField = form.querySelector("#seekerPassword");
          const confirmPasswordField = form.querySelector("#confirmPassword");
          
          if (passwordField && passwordField.value.length < 8) {
            isValid = false;
            passwordField.classList.add("border-red-500");
            errorMessages.push("Password must be at least 8 characters long");
          }
          
          // Validate password confirmation
          if (passwordField && confirmPasswordField) {
            if (passwordField.value !== confirmPasswordField.value) {
              isValid = false;
              confirmPasswordField.classList.add("border-red-500");
              errorMessages.push("Passwords do not match");
            } else {
              confirmPasswordField.classList.remove("border-red-500");
            }
          }
          // Validate terms acceptance
          const termsCheckbox = form.querySelector("#seekerTerms");
          if (termsCheckbox && !termsCheckbox.checked) {
            isValid = false;
            errorMessages.push("Please accept the Terms of Service");
            // Add visual cue to terms section
            const termsContainer = termsCheckbox.closest('.checkbox-container');
            if (termsContainer) {
              termsContainer.classList.add('border-2', 'border-red-500', 'rounded-lg', 'p-2');
              // Remove the visual cue after a few seconds
              setTimeout(() => {
                termsContainer.classList.remove('border-2', 'border-red-500', 'rounded-lg', 'p-2');
              }, 5000);
            }
          }
          // Check text length limit
          const textInputs = form.querySelectorAll('input[type="text"], textarea');
          textInputs.forEach((input) => {
            if (input.value.length > 500) {
              isValid = false;
              input.classList.add("border-red-500");
              errorMessages.push(
                `${input.placeholder || "Text field"} exceeds 500 characters limit`,
              );
            }
          });
          return { isValid, errorMessages };
        }
        function showNotification(message, type = "error") {
          const notification = document.createElement("div");
          notification.className = `fixed top-4 right-4 px-6 py-3 rounded shadow-lg ${
            type === "success" ? "bg-green-500 text-white" : "bg-red-500 text-white"
          }`;
          notification.textContent = message;
          document.body.appendChild(notification);
          setTimeout(() => notification.remove(), 3000);
        }
        async function handleFormSubmit(event) {
          event.preventDefault();
          const form = event.target; 
          console.log("üîî handleFormSubmit fired", { form: form.id });
          console.log("üìù Form data preview:", {
            email: form.querySelector('input[type="email"]')?.value,
            username: form.querySelector('input[placeholder="Username"]')?.value,
            hasPassword: !!form.querySelector('#seekerPassword')?.value
          });
          
          // Check if Supabase is configured
          if (!supabaseClient) {
            showNotification('‚ùå Database not configured. Please check console for setup instructions.', 'error');
            showSupabaseSetupGuide();
            return;
          }
          
          const validation = validateForm(form);
          if (!validation.isValid) {
            validation.errorMessages.forEach((message) => showNotification(message));
            return;
          }

          // Show loading state
          const submitButton = form.querySelector('button[type="submit"], button[type="button"]:last-of-type');
          const originalText = submitButton.textContent;
          submitButton.disabled = true;
          submitButton.innerHTML = '<i class="ri-loader-line animate-spin mr-2"></i>Creating Account...';

          try {
            // Determine if this is job seeker or employer form
            const isJobSeekerForm = form.id === 'jobSeekerRegistrationForm';
            const isEmployerForm = form.id === 'employerRegistrationForm';

            // Get common form data
            const email = form.querySelector('#email')?.value || form.querySelector('input[type="email"]')?.value;
            const password = form.querySelector('#seekerPassword')?.value || form.querySelector('#employerPassword')?.value;
            const username = form.querySelector('#username')?.value || form.querySelector('input[placeholder="Username"]')?.value;

            console.log('üìã Form data collected:', { email, username, hasPassword: !!password });

            if (!email || !password || !username) {
              throw new Error('Missing required fields: email, password, or username');
            }

            // Create auth user first
            const { data: authData, error: authError } = await SupabaseAuth.signUp(email, password, {
              username: username,
              user_type: isJobSeekerForm ? 'job_seeker' : 'employer'
            });

            if (authError) {
              throw new Error(`Authentication failed: ${authError.message}`);
            }

            const userId = authData.user?.id;
            if (!userId) {
              throw new Error('Failed to create user account');
            }

            // Prepare user data based on form type
            let userData = {
              id: userId,
              email: email,
              username: username,
              created_at: new Date().toISOString()
            };

            if (isJobSeekerForm) {
              // Job Seeker specific data
              const firstName = form.querySelector('[name="firstName"]')?.value;
              const surname = form.querySelector('[name="surname"]')?.value;
              const location = form.querySelector('#location')?.value || form.querySelector('input[placeholder*="Location"]')?.value;
              const phone = form.querySelector('#phone')?.value || form.querySelector('input[type="tel"]')?.value;
              const professionalTitle = form.querySelector('#professionalTitle')?.value || form.querySelector('input[placeholder*="Professional Title"]')?.value;
              const travelDistance = form.querySelector('#travelDistance')?.value;
              const relocation = form.querySelector('#willRelocate')?.value;
              const experience = form.querySelector('#experience')?.value;
              const industry = form.querySelector('#industrySelect')?.value;
              
              console.log('üìã Job seeker data:', { firstName, surname, location, industry });
              
              // Get subscription tier
              const selectedTier = form.querySelector('input[name="subscription"]:checked')?.value || 'bronze';
              
              // Get selected jobs
              const selectedJobs = Array.from(document.querySelectorAll("#selectedJobs .bg-gray-100"))
                .map((tag) => tag.textContent.trim().replace(/‚úï$/, "").trim())
                .filter(job => job.length > 0);
              
              // Get skills
              const selectedSkills = Array.from(document.querySelectorAll("#skillTags .bg-gray-100"))
                .map((tag) => tag.textContent.trim().replace(/‚úï$/, "").trim())
                .filter(skill => skill.length > 0);
              
              // Get references
              const reference1Name = form.querySelector('[name="reference1_name"]')?.value;
              const reference1Phone = form.querySelector('[name="reference1_phone"]')?.value;
              const reference2Name = form.querySelector('[name="reference2_name"]')?.value;
              const reference2Phone = form.querySelector('[name="reference2_phone"]')?.value;

              userData = {
                ...userData,
                first_name: firstName,
                surname: surname,
                location: location,
                phone: phone,
                professional_title: professionalTitle,
                travel_distance: travelDistance,
                willing_to_relocate: relocation,
                years_experience: experience,
                industry: industry,
                subscription_tier: selectedTier,
                selected_jobs: selectedJobs,
                skills: selectedSkills,
                reference_1_name: reference1Name,
                reference_1_phone: reference1Phone,
                reference_2_name: reference2Name,
                reference_2_phone: reference2Phone
              };

              // Insert job seeker data
              const { data: dbData, error: dbError } = await SupabaseDB.insertJobSeeker(userData);
              if (dbError) {
                throw new Error(`Database error: ${dbError.message}`);
              }

            } else if (isEmployerForm) {
              // Employer specific data
              const fullName = form.querySelector('input[placeholder="Full Name"]')?.value;
              const position = form.querySelector('input[placeholder="Position/Title"]')?.value;
              const phone = form.querySelector('input[type="tel"]')?.value;
              
              // Get employer type
              const employerType = document.querySelector('.employer-type-card.selected')?.getAttribute('data-type') || 'individual';
              
              // Get business details (if business type)
              let companyName, companyWebsite, industry, companySize;
              if (employerType === 'business') {
                companyName = form.querySelector('input[placeholder="Company Name (Optional)"]')?.value;
                companyWebsite = form.querySelector('input[placeholder="Company Website (Optional)"]')?.value;
                industry = form.querySelector('#industry')?.value;
                companySize = form.querySelector('select option:checked')?.value;
              }

              userData = {
                ...userData,
                full_name: fullName,
                position_title: position,
                phone: phone,
                employer_type: employerType,
                company_name: companyName,
                company_website: companyWebsite,
                industry: industry,
                company_size: companySize
              };

              // Insert employer data
              const { data: dbData, error: dbError } = await SupabaseDB.insertEmployer(userData);
              if (dbError) {
                throw new Error(`Database error: ${dbError.message}`);
              }
            }

            // Handle file uploads if any
            const fileInputs = form.querySelectorAll('input[type="file"]');
            for (const input of fileInputs) {
              if (input.files.length > 0) {
                const file = input.files[0];
                const fileName = `${userId}/${Date.now()}_${file.name}`;
                const bucket = isJobSeekerForm ? 'job-seeker-files' : 'employer-files';
                
                const { data: fileData, error: fileError } = await SupabaseDB.uploadFile(bucket, fileName, file);
                if (fileError) {
                  console.warn('File upload failed:', fileError.message);
                  // Don't fail the entire registration for file upload issues
                }
              }
            }

            // Success!
            showNotification(
              "Your registration has been submitted successfully! Please proceed to payment.",
              "success"
            );

            // Store user data temporarily for payment process
            sessionStorage.setItem('registrationData', JSON.stringify({
              userId: userId,
              userType: isJobSeekerForm ? 'job_seeker' : 'employer',
              userData: userData,
              timestamp: Date.now()
            }));

            // For job seekers, redirect to payment unless skip payment is enabled
            if (isJobSeekerForm) {
              // Check if this is a premium subscription that requires payment
              const selectedTier = userData.subscription_tier;
              if (selectedTier !== 'basic' && !TESTING_MODE) {
                // Show payment modal for premium subscriptions
                showPaymentModal();
              } else {
                // Free tier or testing mode - redirect directly to dashboard
                setTimeout(() => {
                  window.location.href = "job seekers dash.html";
                }, 1000);
              }
            } else {
              // Employers go to their dashboard
              setTimeout(() => {
                window.location.href = "dashboard/employer.html";
              }, 1000);
            }

          } catch (error) {
            console.error('Registration error:', error);
            showNotification(
              `Registration failed: ${error.message}. Please try again.`,
              "error"
            );
          } finally {
            // Restore button state
            submitButton.disabled = false;
            submitButton.innerHTML = originalText;
          }
        }
        const jobSeekerForm = document.getElementById("jobSeekerRegistrationForm");
        const employerForm = document.getElementById("employerRegistrationForm");
        
        console.log("üîó Attaching form event listeners:", {
          jobSeekerForm: !!jobSeekerForm,
          employerForm: !!employerForm
        });
        
        if (jobSeekerForm) {
          jobSeekerForm.addEventListener("submit", handleFormSubmit);
          console.log("‚úÖ Job seeker form submit listener attached");
        } else {
          console.warn("‚ùå Job seeker form not found!");
        }
        
        if (employerForm) {
          employerForm.addEventListener("submit", handleFormSubmit);
          console.log("‚úÖ Employer form submit listener attached");
        } else {
          console.warn("‚ùå Employer form not found!");
        }
        
        // Add backup click handlers to submit buttons
        const jobSeekerSubmitBtn = document.getElementById("jobSeekerSubmit");
        if (jobSeekerSubmitBtn) {
          jobSeekerSubmitBtn.addEventListener("click", function(event) {
            console.log("üñ±Ô∏è Submit button clicked for job seeker form");
            // The form submit event should handle this, but this is a backup
          });
        }
        
        // Add a helper function to manually trigger form submission for testing
        window.testFormSubmission = function() {
          console.log("üß™ Testing form submission...");
          const form = document.getElementById("jobSeekerRegistrationForm");
          if (form) {
            const event = new Event('submit', { bubbles: true, cancelable: true });
            form.dispatchEvent(event);
          } else {
            console.error("Form not found!");
          }
        };
        
        console.log("üí° Form debugging ready. Use testFormSubmission() in console to test manually."); 
      
        const industrySelect = document.getElementById("industrySelect");
        const jobSelect = document.getElementById("jobSelect");
        const selectedJobs = document.getElementById("selectedJobs");
        const skillInput = document.getElementById("skillInput");
        const skillTags = document.getElementById("skillTags");
        const skillsByIndustry = {
          drivers: [
            "Safe Driving",
            "Vehicle Maintenance",
            "Route Planning",
            "Time Management",
            "Customer Service",
            "Loading/Unloading",
            "Traffic Rules",
            "Delivery Tracking",
          ],
          domestic_workers: [
            "Cleaning",
            "Cooking",
            "Laundry",
            "Home Organization",
            "Time Management",
            "Basic English",
            "Child Care",
            "Safety Awareness",
          ],
          child_elder_care: [
            "Patient Care",
            "First Aid",
            "Basic Medical Knowledge",
            "Empathy",
            "Time Management",
            "Basic English",
            "Safety Procedures",
            "Emergency Response",
          ],
          security: [
            "Security Procedures",
            "Surveillance",
            "Emergency Response",
            "Physical Fitness",
            "Communication",
            "Report Writing",
            "Access Control",
            "Safety Protocols",
          ],
          trades: [
            "Hand Tools",
            "Power Tools",
            "Safety Procedures",
            "Basic Math",
            "Problem Solving",
            "Technical Reading",
            "Measurement",
            "Quality Control",
          ],
          construction: [
            "Physical Strength",
            "Safety Awareness",
            "Basic Tools",
            "Team Work",
            "Following Instructions",
            "Basic Math",
            "Material Handling",
            "Equipment Operation",
          ],
          retail_hospitality: [
            "Customer Service",
            "Cash Handling",
            "Stock Management",
            "Basic Math",
            "Communication",
            "Basic English",
            "Team Work",
            "Sales",
          ],
          admin: [
            "Basic Computer",
            "Filing",
            "Phone Etiquette",
            "Basic English",
            "Organization",
            "Time Management",
            "Customer Service",
            "Basic Math",
          ],
          warehouse: [
            "Inventory Management",
            "Loading/Unloading",
            "Safety Procedures",
            "Physical Fitness",
            "Basic Math",
            "Stock Control",
            "Equipment Operation",
            "Team Work",
          ],
          event_staff: [
            "Customer Service",
            "Physical Fitness",
            "Team Work",
            "Time Management",
            "Safety Awareness",
            "Basic English",
            "Problem Solving",
            "Communication",
          ],
          mechanics: [
            "Vehicle Repair",
            "Tool Knowledge",
            "Diagnostic Skills",
            "Safety Procedures",
            "Problem Solving",
            "Technical Reading",
            "Quality Control",
            "Equipment Maintenance",
          ],
          agriculture_farm_work: [
            "Physical Fitness",
            "Equipment Operation",
            "Safety Awareness",
            "Basic Tools",
            "Weather Knowledge",
            "Crop Management",
            "Team Work",
            "Time Management",
          ],
        };
        function updateSkillSuggestions(industry) {
          if (industry && skillsByIndustry[industry]) {
            const currentSkills = Array.from(skillTags.children).map((tag) =>
              tag.textContent.trim().replace(/‚úï$/, "").trim(),
            );
            skillTags.innerHTML = "";
            skillsByIndustry[industry]
              .filter((skill) => !currentSkills.includes(skill))
              .slice(0, 3)
              .forEach((skill) => {
                const tag = document.createElement("div");
                tag.className =
                  "bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center";
                tag.innerHTML = `
      ${skill}
      <button type="button" class="ml-1 text-gray-500 hover:text-gray-700">
      <i class="ri-close-line"></i>
      </button>
      `;
                skillTags.appendChild(tag);
              });
          }
        }
        industrySelect.addEventListener("change", function () {
          updateJobSelect(this.value);
          updateSkillSuggestions(this.value);
          calculateTotalAmount();
        });
        skillTags.addEventListener("click", function (e) {
          if (e.target.closest("button")) {
            e.target.closest(".bg-gray-100").remove();
          }
        });
        skillInput.addEventListener("keypress", function (e) {
          if (e.key === "Enter" && this.value.trim()) {
            const tag = document.createElement("div");
            tag.className =
              "bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center";
            tag.innerHTML = `
      ${this.value.trim()}
      <button type="button" class="ml-1 text-gray-500 hover:text-gray-700">
      <i class="ri-close-line"></i>
      </button>
      `;
            skillTags.appendChild(tag);
            this.value = "";
          }
        });
        const jobPrices = {
          drivers: 285,
          domestic_workers: 99,
          child_elder_care: 99,
          security: 199,
          trades: 199,
          construction: 199,
          retail_hospitality: 99,
          admin: 199,
          warehouse: 99,
          event_staff: 199,
          mechanics: 285,
          agriculture_farm_work: 99,
        };
        const jobsByIndustry = {
          drivers: [
            "Delivery Driver",
            "Truck Driver",
            "Taxi Driver",
            "Bus Driver",
            "Courier",
            "Chauffeur",
            "Fleet Driver",
            "Moving Van Driver",
          ],
          domestic_workers: [
            "House Cleaner",
            "Housekeeper",
            "Domestic Helper",
            "Home Assistant",
            "Laundry Worker",
            "Cook",
            "House Manager",
          ],
          child_elder_care: [
            "Childcare Worker",
            "Elder Care Assistant",
            "Babysitter",
            "Nanny",
            "Care Home Assistant",
            "Special Needs Caregiver",
            "Personal Care Aide",
          ],
        
          security: [
            "Security Guard",
            "Security Officer",
            "Night Watch",
            "Patrol Officer",
            "Loss Prevention Officer",
            "Event Security",
            "Building Security",
          ],
          trades: [
            "Electrician",
            "Plumber",
            "Carpenter",
            "HVAC Technician",
            "Painter",
            "Welder",
            "Handyman",
          ],
          construction: [
            "Construction Worker",
            "Laborer",
            "Bricklayer",
            "Roofer",
            "Concrete Worker",
            "Equipment Operator",
            "Site Worker",
          ],
          retail_hospitality: [
            "Sales Associate",
            "Cashier",
            "Store Clerk",
            "Restaurant Server",
            "Barista",
            "Hotel Staff",
            "Customer Service",
          ],
          admin: [
            "Office Assistant",
            "Receptionist",
            "Data Entry Clerk",
            "Administrative Assistant",
            "Office Manager",
            "Secretary",
            "File Clerk",
          ],
          warehouse: [
            "Warehouse Worker",
            "Forklift Operator",
            "Picker/Packer",
            "Shipping Clerk",
            "Inventory Clerk",
            "Loading Dock Worker",
            "Stock Handler",
          ],
          event_staff: [
            "Event Staff",
            "Banquet Server",
            "Setup Crew",
            "Usher",
            "Ticket Taker",
            "Concession Worker",
            "Stage Hand",
          ],
          mechanics: [
            "Truck Mechanic",
            "Diesel Mechanic",
            "Fleet Mechanic",
            "Auto Technician",
            "Heavy Equipment Mechanic",
            "Service Technician",
            "Repair Specialist",
          ],
          agriculture_farm_work: [
            "Farm Worker",
            "Field Hand",
            "Harvester",
            "Ranch Worker",
            "Greenhouse Worker",
            "Agricultural Laborer",
            "Farm Equipment Operator",
          ],
        };
        let selectedJobsArray = [];
        function calculateTotalAmount() {
          const selectedIndustry = industrySelect.value;
          const price = jobPrices[selectedIndustry] || 0;
          const totalAmount = document.getElementById("totalAmount");
          totalAmount.textContent = `R ${price.toFixed(2)}`;
        }
        function updateJobSelect(industry) {
          jobSelect.innerHTML = '<option value="">Select Position</option>';
          if (industry && jobsByIndustry[industry]) {
            jobsByIndustry[industry].forEach((job) => {
              if (!selectedJobsArray.includes(job)) {
                const option = document.createElement("option");
                option.value = job;
                option.textContent = job;
                option.setAttribute("data-price", jobPrices[industry]);
                jobSelect.appendChild(option);
              }
            });
          }
          calculateTotalAmount();
        }
        function createJobTag(job) {
          const tag = document.createElement("div");
          tag.className =
            "bg-gray-100 text-gray-800 px-3 py-1 rounded-full text-sm flex items-center";
          tag.innerHTML = `
      ${job}
      <button type="button" class="ml-1 text-gray-500 hover:text-gray-700" data-job="${job}">
      <i class="ri-close-line"></i>
      </button>
      `;
          return tag;
        }
        industrySelect.addEventListener("change", function () {
          updateJobSelect(this.value);
        });
        jobSelect.addEventListener("change", function () {
          if (this.value && !selectedJobsArray.includes(this.value)) {
            selectedJobsArray.push(this.value);
            selectedJobs.appendChild(createJobTag(this.value));
            this.selectedIndex = 0;
            updateJobSelect(industrySelect.value);
          }
        });
        selectedJobs.addEventListener("click", function (e) {
          if (e.target.closest("button")) {
            const jobToRemove = e.target.closest("button").getAttribute("data-job");
            selectedJobsArray = selectedJobsArray.filter(
              (job) => job !== jobToRemove,
            );
            e.target.closest(".bg-gray-100").remove();
            updateJobSelect(industrySelect.value);
          }
        });
      });
    </script>

    <!-- Payment Portal Modal -->
    <div id="paymentModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
      <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-hidden">
        <div class="flex justify-between items-center p-6 border-b">
          <h2 class="text-2xl font-bold">Complete Your Payment</h2>
          <button onclick="closeModal('paymentModal')" class="text-gray-500 hover:text-gray-700">
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <div class="p-6 overflow-y-auto max-h-[75vh]">
          <!-- Order Summary -->
          <div class="bg-gray-50 rounded-lg p-4 mb-6">
            <h3 class="font-semibold mb-3">Order Summary</h3>
            <div id="orderSummaryContent">
              <div class="flex justify-between items-center mb-2">
                <span>Bronze Verification Package</span>
                <span class="font-semibold">R299</span>
              </div>
              <div class="flex justify-between items-center text-sm text-gray-600 mb-2">
                <span>Processing Fee</span>
                <span>R15</span>
              </div>
              <div class="border-t pt-2 flex justify-between items-center font-bold">
                <span>Total</span>
                <span class="text-primary">R314</span>
              </div>
            </div>
          </div>

          <!-- Payment Options -->
          <h3 class="font-medium mb-4">Choose your payment method:</h3>
          
          <div id="paymentOptions" class="space-y-3">
            <!-- Payment options will be dynamically inserted here -->
          </div>

          <!-- Security Notice -->
          <div class="mt-6 p-3 bg-green-50 border border-green-200 rounded-lg">
            <div class="flex items-start">
              <i class="ri-shield-check-line text-green-600 mr-2 mt-1"></i>
              <div class="text-sm text-green-800">
                <strong>Secure Payment:</strong> All payments are processed through secure, PCI-compliant payment gateways. Your financial information is protected with bank-level security.
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Terms of Service Modal -->
    <div id="termsModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
      <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden">
        <div class="flex justify-between items-center p-6 border-b">
          <h2 class="text-2xl font-bold">Terms of Service</h2>
          <button onclick="closeModal('termsModal')" class="text-gray-500 hover:text-gray-700">
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <div class="bg-blue-50 border-l-4 border-blue-400 p-4 mx-6 mt-4">
          <div class="flex">
            <div class="flex-shrink-0">
              <i class="ri-information-line text-blue-400"></i>
            </div>
            <div class="ml-3">
              <p class="text-sm text-blue-700">
                Please read through our terms carefully. Click "Accept Terms & Continue" below to proceed with registration.
              </p>
            </div>
          </div>
        </div>
        <div class="p-6 overflow-y-auto max-h-[70vh]">
          <div class="prose max-w-none">
            <h3>1. Acceptance of Terms</h3>
            <p>By accessing and using Verify's services, you accept and agree to be bound by the terms and provision of this agreement.</p>
            
            <h3>2. Service Description</h3>
            <p>Verify provides document verification services to connect job seekers with potential employers in South Africa.</p>
            
            <h3>3. User Responsibilities</h3>
            <p>Users must provide accurate information and maintain the confidentiality of their account credentials.</p>
            
            <h3>4. Privacy and Data Protection</h3>
            <p>We collect and process personal information in accordance with our Privacy Policy and applicable data protection laws.</p>
            
            <h3>5. Payment Terms</h3>
            <p>All fees for verification services are clearly stated and must be paid in advance.</p>
            
            <h3>6. Limitation of Liability</h3>
            <p>Verify's liability is limited to the extent permitted by law.</p>
            
            <h3>7. Termination</h3>
            <p>Either party may terminate this agreement with appropriate notice.</p>
            
            <h3>8. Governing Law</h3>
            <p>These terms are governed by the laws of South Africa.</p>
          </div>
        </div>
        <div class="flex justify-between items-center p-6 border-t bg-gray-50">
          <button onclick="closeModal('termsModal')" class="bg-gray-300 text-gray-700 px-6 py-2 rounded-button hover:bg-gray-400">
            Cancel
          </button>
          <button onclick="acceptTerms()" class="bg-primary text-white px-6 py-2 rounded-button hover:bg-red-600">
            Accept Terms & Continue
          </button>
        </div>
      </div>
    </div>

    <!-- Privacy Policy Modal -->
    <div id="privacyModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
      <div class="bg-white rounded-lg max-w-4xl w-full max-h-[90vh] overflow-hidden">
        <div class="flex justify-between items-center p-6 border-b">
          <h2 class="text-2xl font-bold">Privacy Policy</h2>
          <button onclick="closeModal('privacyModal')" class="text-gray-500 hover:text-gray-700">
            <i class="ri-close-line text-2xl"></i>
          </button>
        </div>
        <div class="p-6 overflow-y-auto max-h-[70vh]">
          <div class="prose max-w-none">
            <h3>Information We Collect</h3>
            <p>We collect personal information including name, contact details, identity documents, and employment history for verification purposes.</p>
            
            <h3>How We Use Your Information</h3>
            <p>Your information is used to verify your identity and qualifications, connect you with employers, and improve our services.</p>
            
            <h3>Information Sharing</h3>
            <p>We share verified information with potential employers only with your consent. We do not sell personal information to third parties.</p>
            
            <h3>Data Security</h3>
            <p>We implement appropriate security measures to protect your personal information against unauthorized access, alteration, disclosure, or destruction.</p>
            
            <h3>Your Rights</h3>
            <p>You have the right to access, update, or delete your personal information. Contact us to exercise these rights.</p>
            
            <h3>Data Retention</h3>
            <p>We retain your information for as long as necessary to provide our services or as required by law.</p>
            
            <h3>Contact Information</h3>
            <p>For privacy-related questions, contact us at privacy@verify.co.za</p>
          </div>
        </div>
        <div class="flex justify-between items-center p-6 border-t bg-gray-50">
          <button onclick="closeModal('privacyModal')" class="bg-gray-300 text-gray-700 px-6 py-2 rounded-button hover:bg-gray-400">
            Cancel
          </button>
          <button onclick="acceptPrivacy()" class="bg-primary text-white px-6 py-2 rounded-button hover:bg-red-600">
            Accept Privacy Policy
          </button>
        </div>
      </div>
    </div>

    <script>
      // Configuration - Set to false for production
      // Configuration for testing/development mode
      // Set to true for development/testing (enables skip payment option)
      // Set to false for production deployment (removes all testing features)
      const TESTING_MODE = true; // Change to false for production deployment
      
      // Modal functions
      function openModal(modalId) {
        document.getElementById(modalId).classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      }
      
      function closeModal(modalId) {
        document.getElementById(modalId).classList.add('hidden');
        document.body.style.overflow = 'auto';
      }
      
      // Payment modal function
      function showPaymentModal() {
        console.log('üè¶ Opening payment modal');
        
        // Update payment details in modal
        const registrationData = sessionStorage.getItem('registrationData');
        if (registrationData) {
          const data = JSON.parse(registrationData);
          const subscriptionTier = data.userData?.subscription_tier || 'bronze';
          
          // Update modal content based on subscription
          updatePaymentModalContent(subscriptionTier);
        }
        
        openModal('paymentModal');
      }

      // Terms and conditions functionality
      function acceptTerms() {
        // Check both job seeker and employer terms checkboxes
        const seekerTermsCheckbox = document.getElementById('seekerTerms');
        const employerTermsCheckbox = document.getElementById('employerTerms');
        
        if (seekerTermsCheckbox) {
          seekerTermsCheckbox.checked = true;
          console.log('‚úÖ Job seeker terms accepted and checkbox checked');
        }
        
        if (employerTermsCheckbox) {
          employerTermsCheckbox.checked = true;
          console.log('‚úÖ Employer terms accepted and checkbox checked');
        }
        
        showNotification('Terms & Conditions accepted!', 'success');
        closeModal('termsModal');
      }

      function acceptPrivacy() {
        console.log('‚úÖ Privacy Policy acknowledged');
        showNotification('Privacy Policy acknowledged!', 'success');
        closeModal('privacyModal');
        // If both terms and privacy need to be accepted, you can handle that logic here
      }
      
      // Payment Portal Functions
      function openPaymentPortal() {
        console.log('openPaymentPortal called');
        
        // Detect user type based on which form is visible
        const jobSeekerForm = document.getElementById('jobSeekerRegisrForm');
        const employerForm = document.getElementById('employerForm');
        
        console.log('jobSeekerForm:', jobSeekerForm);
        console.log('employerForm:', employerForm);
        
        let userType = 'seeker';
        if (employerForm && !employerForm.classList.contains('hidden')) {
          userType = 'employer';
        }
        
        console.log('Detected user type:', userType);
        
        // Update payment portal and open modal
        updatePaymentPortal(userType);
        openModal('paymentModal');
        generateQRCode();
      }
      
      function updatePaymentPortal(userType) {
        const orderSummary = document.getElementById('orderSummaryContent');
        const paymentOptions = document.getElementById('paymentOptions');
        
        if (userType === 'employer') {
          // Update order summary for employer
          orderSummary.innerHTML = `
            <div class="flex justify-between items-center mb-2">
              <span>Employer Account Setup</span>
              <span class="font-semibold">R0</span>
            </div>
            <div class="text-sm text-gray-600 mb-2">
              No upfront cost - Pay per CV bundle purchased
            </div>
            <div class="border-t pt-2 flex justify-between items-center font-bold">
              <span>Total</span>
              <span class="text-primary">R0</span>
            </div>
          `;
          
          // Show premium payment options for employers
          paymentOptions.innerHTML = `
            <!-- PayFast (Default) -->
            <button id="payfastBtn" class="w-full p-4 border-2 border-primary bg-primary/5 rounded-lg hover:bg-primary/10 transition-colors text-left">
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <i class="ri-bank-card-line text-2xl text-primary mr-3"></i>
                  <div>
                    <div class="font-semibold text-gray-900">Pay with Card / EFT</div>
                    <div class="text-sm text-gray-600">Visa, Mastercard, EFT (PayFast)</div>
                  </div>
                </div>
                <span class="bg-primary text-white px-2 py-1 rounded text-xs font-medium">RECOMMENDED</span>
              </div>
            </button>

            <!-- Apple Pay -->
            <button id="applePay" class="w-full p-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-left">
              <div class="flex items-center">
                <i class="ri-apple-line text-2xl text-gray-800 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Apple Pay</div>
                  <div class="text-sm text-gray-600">Quick & secure payment with Touch ID / Face ID</div>
                </div>
              </div>
            </button>

            <!-- Google Pay -->
            <button id="googlePay" class="w-full p-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-left">
              <div class="flex items-center">
                <i class="ri-google-line text-2xl text-blue-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Google Pay</div>
                  <div class="text-sm text-gray-600">Fast checkout with saved payment methods</div>
                </div>
              </div>
            </button>

            <!-- Ozow Instant EFT -->
            <button id="ozowPay" class="w-full p-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-left">
              <div class="flex items-center">
                <i class="ri-bank-line text-2xl text-green-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Pay with Instant EFT</div>
                  <div class="text-sm text-gray-600">Direct bank transfer (Ozow)</div>
                </div>
              </div>
            </button>

            <!-- Recurring Card Billing -->
            <div class="border border-gray-300 rounded-lg p-4">
              <div class="flex items-center mb-3">
                <i class="ri-refresh-line text-2xl text-purple-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Recurring Card Billing</div>
                  <div class="text-sm text-gray-600">Set up automatic payments for CV bundles</div>
                </div>
              </div>
              <div class="bg-blue-50 rounded p-3 text-sm">
                <div class="flex items-start">
                  <i class="ri-information-line text-blue-600 mr-2 mt-1"></i>
                  <div class="text-blue-800">
                    <strong>Enterprise Feature:</strong> Setup recurring billing for regular CV bundle purchases. Perfect for agencies and high-volume recruiters.
                  </div>
                </div>
              </div>
            </div>

            <!-- Zapper QR Code -->
            <div class="border border-gray-300 rounded-lg p-4">
              <div class="flex items-center mb-3">
                <i class="ri-qr-code-line text-2xl text-purple-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Pay with Zapper / Wallet QR</div>
                  <div class="text-sm text-gray-600">Scan to pay with your mobile wallet</div>
                </div>
              </div>
              <div id="zapper-qr" class="flex justify-center bg-white border border-gray-200 rounded p-4">
                <!-- QR Code placeholder -->
                <div class="w-32 h-32 bg-gray-100 border-2 border-dashed border-gray-300 rounded flex items-center justify-center">
                  <div class="text-center">
                    <i class="ri-qr-code-line text-3xl text-gray-400 mb-2"></i>
                    <div class="text-xs text-gray-500">QR Code will appear here</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Manual Bank Transfer -->
            <div class="border border-gray-300 rounded-lg p-4">
              <div class="flex items-center mb-3">
                <i class="ri-building-line text-2xl text-blue-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Direct Bank Transfer</div>
                  <div class="text-sm text-gray-600">Transfer directly to our bank account</div>
                </div>
              </div>
              <div class="bg-gray-50 rounded p-3 text-sm">
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Bank:</div>
                  <div>First National Bank</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Account Name:</div>
                  <div>Verify (Pty) Ltd</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Account Number:</div>
                  <div>1234567890</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Branch Code:</div>
                  <div>250655</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-3">
                  <div class="font-medium">Reference:</div>
                  <div class="font-mono bg-yellow-100 px-2 py-1 rounded">EMP-2025-001</div>
                </div>
                <div class="text-xs text-gray-600 border-t pt-2">
                  <strong>Important:</strong> Please use the reference number above and email proof of payment to payments@verify.co.za
                </div>
              </div>
            </div>

            ${TESTING_MODE ? `
            <!-- Testing Skip Payment Option -->
            <button id="skipPaymentBtn" class="w-full border-2 border-yellow-300 bg-yellow-50 rounded-lg p-4 hover:bg-yellow-100 transition-colors text-left">
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <i class="ri-tools-line text-2xl text-yellow-600 mr-3"></i>
                  <div>
                    <div class="font-semibold text-gray-900">Skip Payment (Testing Mode)</div>
                    <div class="text-sm text-yellow-700">For development and testing purposes only</div>
                  </div>
                </div>
                <span class="bg-yellow-500 text-white px-2 py-1 rounded text-xs font-medium">TEST ONLY</span>
              </div>
            </button>
            ` : ''}
          `;
        } else {
          // Job seeker payment options
          orderSummary.innerHTML = `
            <div class="flex justify-between items-center mb-2">
              <span>Bronze Verification Package</span>
              <span class="font-semibold">R299</span>
            </div>
            <div class="flex justify-between items-center text-sm text-gray-600 mb-2">
              <span>Processing Fee</span>
              <span>R15</span>
            </div>
            <div class="border-t pt-2 flex justify-between items-center font-bold">
              <span>Total</span>
              <span class="text-primary">R314</span>
            </div>
          `;
          
          paymentOptions.innerHTML = `
            <!-- PayFast (Default) -->
            <button id="payfastBtn" class="w-full p-4 border-2 border-primary bg-primary/5 rounded-lg hover:bg-primary/10 transition-colors text-left">
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <i class="ri-bank-card-line text-2xl text-primary mr-3"></i>
                  <div>
                    <div class="font-semibold text-gray-900">Pay with Card / EFT</div>
                    <div class="text-sm text-gray-600">Visa, Mastercard, EFT (PayFast)</div>
                  </div>
                </div>
                <span class="bg-primary text-white px-2 py-1 rounded text-xs font-medium">RECOMMENDED</span>
              </div>
            </button>

            <!-- Ozow Instant EFT -->
            <button id="ozowPay" class="w-full p-4 border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors text-left">
              <div class="flex items-center">
                <i class="ri-bank-line text-2xl text-green-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Pay with Instant EFT</div>
                  <div class="text-sm text-gray-600">Direct bank transfer (Ozow)</div>
                </div>
              </div>
            </button>

            <!-- Zapper QR Code -->
            <div class="border border-gray-300 rounded-lg p-4">
              <div class="flex items-center mb-3">
                <i class="ri-qr-code-line text-2xl text-purple-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Pay with Zapper / Wallet QR</div>
                  <div class="text-sm text-gray-600">Scan to pay with your mobile wallet</div>
                </div>
              </div>
              <div id="zapper-qr" class="flex justify-center bg-white border border-gray-200 rounded p-4">
                <!-- QR Code placeholder -->
                <div class="w-32 h-32 bg-gray-100 border-2 border-dashed border-gray-300 rounded flex items-center justify-center">
                  <div class="text-center">
                    <i class="ri-qr-code-line text-3xl text-gray-400 mb-2"></i>
                    <div class="text-xs text-gray-500">QR Code will appear here</div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Manual Bank Transfer -->
            <div class="border border-gray-300 rounded-lg p-4">
              <div class="flex items-center mb-3">
                <i class="ri-building-line text-2xl text-blue-600 mr-3"></i>
                <div>
                  <div class="font-semibold text-gray-900">Direct Bank Transfer</div>
                  <div class="text-sm text-gray-600">Transfer directly to our bank account</div>
                </div>
              </div>
              <div class="bg-gray-50 rounded p-3 text-sm">
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Bank:</div>
                  <div>First National Bank</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Account Name:</div>
                  <div>Verify (Pty) Ltd</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Account Number:</div>
                  <div>1234567890</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-2">
                  <div class="font-medium">Branch Code:</div>
                  <div>250655</div>
                </div>
                <div class="grid grid-cols-2 gap-2 mb-3">
                  <div class="font-medium">Reference:</div>
                  <div class="font-mono bg-yellow-100 px-2 py-1 rounded">VER-2025-001</div>
                </div>
                <div class="text-xs text-gray-600 border-t pt-2">
                  <strong>Important:</strong> Please use the reference number above and email proof of payment to payments@verify.co.za
                </div>
              </div>
            </div>

            ${TESTING_MODE ? `
            <!-- Testing Skip Payment Option -->
            <button id="skipPaymentBtn" class="w-full border-2 border-yellow-300 bg-yellow-50 rounded-lg p-4 hover:bg-yellow-100 transition-colors text-left">
              <div class="flex items-center justify-between">
                <div class="flex items-center">
                  <i class="ri-tools-line text-2xl text-yellow-600 mr-3"></i>
                  <div>
                    <div class="font-semibold text-gray-900">Skip Payment (Testing Mode)</div>
                    <div class="text-sm text-yellow-700">For development and testing purposes only</div>
                  </div>
                </div>
                <span class="bg-yellow-500 text-white px-2 py-1 rounded text-xs font-medium">TEST ONLY</span>
              </div>
            </button>
            ` : ''}

            </div>
          `;
        }
      }
      
      function validateRegistrationForm(form) {
        // For now, always return true to allow payment portal to open
        // Add your form validation logic here if needed
        return true;
      }
      
      function getCurrentUserType() {
        // Determine user type based on which form is currently visible
        const jobSeekerForm = document.getElementById('jobSeekerForm');
        const employerForm = document.getElementById('employerForm');
        
        if (employerForm && !employerForm.classList.contains('hidden')) {
          return 'employer';
        }
        return 'seeker'; // default to job seeker
      }
      
      // Payment completion handler
      function handlePaymentSuccess(paymentMethod) {
        console.log(`üí≥ Payment successful via ${paymentMethod}`);
        
        // Show success message
        showNotification(`Payment successful via ${paymentMethod}! Redirecting to dashboard...`, 'success');
        
        // Get registration data
        const registrationData = sessionStorage.getItem('registrationData');
        if (registrationData) {
          const data = JSON.parse(registrationData);
          console.log('Registration data found:', data.userType);
          
          // Update user status to paid in Supabase (if needed)
          // This is where you'd mark the subscription as active
          
          // Redirect to appropriate dashboard
          setTimeout(() => {
            if (data.userType === 'employer') {
              window.location.href = 'dashboard/employer.html';
            } else {
              window.location.href = 'job seekers dash.html';
            }
            
            // Clear registration data after successful payment
            sessionStorage.removeItem('registrationData');
          }, 1500); // 1.5 second delay to show success message
          
        } else {
          console.warn('No registration data found in session storage');
          // Fallback redirect
          setTimeout(() => {
            window.location.href = 'job seekers dash.html';
          }, 1500);
        }
        
        // Close payment modal
        closeModal('paymentModal');
      }

      function handleSkipPayment() {
        if (!TESTING_MODE) {
          alert('Skip payment is only available in testing mode.');
          return;
        }
        
        console.log('Skip payment clicked - redirecting to dashboard');
        
        // Get registration data from session storage
        const registrationData = sessionStorage.getItem('registrationData');
        if (registrationData) {
          const data = JSON.parse(registrationData);
          console.log('Registration data found:', data.userType);
          
          // Determine which dashboard to redirect to based on user type
          if (data.userType === 'employer') {
            window.location.href = 'dashboard/employer.html';
          } else {
            window.location.href = 'job seekers dash.html';
          }
          
          // Clear registration data
          sessionStorage.removeItem('registrationData');
        } else {
          // Fallback if no registration data
          const userType = getCurrentUserType();
          if (userType === 'employer') {
            window.location.href = 'dashboard/employer.html';
          } else {
            window.location.href = 'job seekers dash.html';
          }
        }
        
        // Close payment modal
        closeModal('paymentModal');
      }
      
      function generateQRCode() {
        // Generate QR code for Zapper payment
        const qrContainer = document.getElementById('zapper-qr');
        // This would integrate with your actual QR code generation service
        qrContainer.innerHTML = `
          <div class="w-32 h-32 bg-white border rounded flex items-center justify-center">
            <div class="text-center">
              <i class="ri-qr-code-line text-4xl text-purple-600 mb-1"></i>
              <div class="text-xs text-gray-600">Scan with Zapper</div>
            </div>
          </div>
        `;
      }
      
      // Payment Method Handlers
      document.addEventListener('DOMContentLoaded', function() {
        // Show Supabase setup guide if not configured
        showSupabaseSetupGuide();
        
        // Test database connection
        testDatabaseConnection();
        
        // Show/hide testing mode indicator and log status
        const testingIndicator = document.getElementById('testingModeIndicator');
        if (testingIndicator) {
          testingIndicator.style.display = TESTING_MODE ? 'block' : 'none';
        }
        
        if (TESTING_MODE) {
          console.log('üîß TESTING MODE ENABLED - Skip payment options available');
        } else {
          console.log('üîí PRODUCTION MODE - All testing features disabled');
        }
        
        // Event delegation for dynamically added payment buttons
        document.addEventListener('click', function(e) {
          if (e.target.id === 'payfastBtn' || e.target.closest('#payfastBtn')) {
            // Redirect to PayFast payment gateway
            console.log('Processing PayFast payment...');
            handlePaymentSuccess('PayFast');
          }
          
          if (e.target.id === 'skipPaymentBtn' || e.target.closest('#skipPaymentBtn')) {
            e.preventDefault();
            handleSkipPayment();
          }
          
          if (e.target.id === 'ozowPay' || e.target.closest('#ozowPay')) {
            // Redirect to Ozow payment gateway
            console.log('Processing Ozow payment...');
            handlePaymentSuccess('Ozow');
          }
          
          if (e.target.id === 'applePay' || e.target.closest('#applePay')) {
            // Apple Pay integration
            console.log('Processing Apple Pay...');
            handlePaymentSuccess('Apple Pay');
          }
          
          if (e.target.id === 'googlePay' || e.target.closest('#googlePay')) {
            // Google Pay integration
            console.log('Processing Google Pay...');
            handlePaymentSuccess('Google Pay');
          }
        });
      });
      
      // Close modal when clicking outside
      window.addEventListener('click', function(e) {
        if (e.target.classList.contains('bg-black') && e.target.classList.contains('bg-opacity-50')) {
          const modals = ['paymentModal', 'termsModal', 'privacyModal'];
          modals.forEach(modalId => {
            if (!document.getElementById(modalId).classList.contains('hidden')) {
              closeModal(modalId);
            }
          });
        }
      });
    </script>
  </body>
</html>
